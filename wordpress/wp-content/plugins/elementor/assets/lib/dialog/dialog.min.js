/*! dialogs-manager v3.2.3 | (c) Kobi Zaltzberg | https://github.com/kobizz/dialogs-manager/blob/master/LICENSE.txt
 2017-07-19 12:29 */
!function(a,b){"use strict";var c={widgetsTypes:{},createWidgetType:function(b,d,e){e||(e=this.Widget);var f=function(){e.apply(this,arguments)},g=f.prototype=new e(b);return a.extend(g,d),g.constructor=f,f.extend=function(a,b){return c.createWidgetType(a,b,f)},f},addWidgetType:function(a,b,c){return b&&b.prototype instanceof this.Widget?this.widgetsTypes[a]=b:this.widgetsTypes[a]=this.createWidgetType(a,b,c)},getWidgetType:function(a){return this.widgetsTypes[a]}};c.Instance=function(){var b=this,d={},e={},f=function(){d.body=a("body")},g=function(b){var c={classPrefix:"dialog",effects:{show:"fadeIn",hide:"fadeOut"}};a.extend(e,c,b)};this.createWidget=function(a,d){var e=c.getWidgetType(a),f=new e(a);return d=d||{},f.init(b,d),f.setMessage(d.message),f},this.getSettings=function(a){return a?e[a]:Object.create(e)},this.init=function(a){return g(a),f(),b},b.init()},c.Widget=function(b){var d=this,e={},f={},g={},h=["refreshPosition"],i=function(){g.window.on("keyup",q),e.hide.onBackgroundClick&&g.widget.on("click",p),e.position.autoRefresh&&g.window.on("resize",d.refreshPosition)},j=function(b,c){var d=e.effects[b],f=g.widget;if(a.isFunction(d))d.apply(f,c);else{if(!f[d])throw"Reference Error: The effect "+d+" not found";f[d].apply(f,c)}},k=function(){var b=h.concat(d.getClosureMethods());a.each(b,function(){var a=this,b=d[a];d[a]=function(){b.apply(d,arguments)}})},l=function(){d.addElement("widget"),d.addElement("message"),d.addElement("window",window),d.addElement("container",e.container);var a=d.getSettings("id");a&&d.setID(a);var b=d.getSettings("className");b&&d.getElements("widget").addClass(b)},m=function(c,f){var g=c.getSettings();e={effects:g.effects,classes:{globalPrefix:g.classPrefix,prefix:g.classPrefix+"-"+b},container:"body",position:{element:"widget",my:"center",at:"center",of:"container",enable:!0,autoRefresh:!1},hide:{auto:!1,autoDelay:5e3,onBackgroundClick:!0}},a.extend(!0,e,d.getDefaultSettings(),f),n()},n=function(){a.each(e,function(a){var b=a.match(/^on([A-Z].*)/);b&&(b=b[1].charAt(0).toLowerCase()+b[1].slice(1),d.on(b,this))})},o=function(a){return a.replace(/([a-z])([A-Z])/g,function(){return arguments[1]+"-"+arguments[2].toLowerCase()})},p=function(a){a.target===this&&d.hide()},q=function(a){var b=27,c=a.which;b===c&&d.hide()},r=function(){g.window.off("keyup",q),e.hide.onBackgroundClick&&g.widget.off("click",p),e.position.autoRefresh&&g.window.off("resize",d.refreshPosition)};this.addElement=function(b,c,d){var f,h=g[b]=a(c||"<div>"),i=o(b);return f=e.classes[b]?e.classes[b]:e.classes.prefix+"-"+i,d||(d=i),f+=" "+e.classes.globalPrefix+"-"+d,h.addClass(f),h},this.getSettings=function(a){var b=Object.create(e);return a?b[a]:b},this.init=function(a,b){if(!(a instanceof c.Instance))throw"The "+d.widgetName+" must to be initialized from an instance of DialogsManager.Instance";return k(),d.trigger("init",b),m(a,b),l(),d.buildWidget(),d.attachEvents&&d.attachEvents(),d.trigger("ready"),d},this.getElements=function(a){return a?g[a]:g},this.hide=function(){return j("hide",arguments),r(),d.trigger("hide"),d},this.on=function(a,b){return f[a]||(f[a]=[]),f[a].push(b),d},this.setMessage=function(a){return g.message.html(a),d},this.setID=function(a){return d.getElements("widget").attr("id",a),d},this.setSettings=function(b,c){return"object"==typeof c?a.extend(!0,e[b],c):e[b]=c,d},this.show=function(){return g.widget.appendTo(g.container),j("show",arguments),d.refreshPosition(),e.hide.auto&&setTimeout(d.hide,e.hide.autoDelay),i(),d.trigger("show"),d},this.refreshPosition=function(){if(e.position.enable){var b=a.extend({},e.position);g[b.of]&&(b.of=g[b.of]),g[b.element].position(b)}},this.trigger=function(b,c){var e="on"+b[0].toUpperCase()+b.slice(1);d[e]&&d[e](c);var g=f[b];if(g)return a.each(g,function(a,b){b.call(d,c)}),d}},c.Widget.prototype.buildWidget=function(){var a=this.getElements();a.widget.html(a.message)},c.Widget.prototype.getDefaultSettings=function(){return{}},c.Widget.prototype.getClosureMethods=function(){return[]},c.Widget.prototype.onHide=function(){},c.Widget.prototype.onShow=function(){},c.Widget.prototype.onInit=function(){},c.Widget.prototype.onReady=function(){},c.widgetsTypes.simple=c.Widget,c.addWidgetType("lightbox",{getDefaultSettings:function(){return{headerMessage:"",contentWidth:"auto",contentHeight:"auto",closeButton:!1,closeButtonClass:"fa fa-times",position:{element:"widgetContent",of:"widget",autoRefresh:!0}}},buildWidget:function(){var a=this.addElement("widgetHeader"),b=this.addElement("widgetContent"),c=this.getElements();if(b.append(a,c.message),c.widget.html(b),this.getSettings("closeButton")){var d=this.addElement("closeButton",'<div><i class="'+this.getSettings("closeButtonClass")+'"></i></div>');b.prepend(d)}},attachEvents:function(){this.getSettings("closeButton")&&this.getElements("closeButton").on("click",this.hide)},onReady:function(){var a=this.getElements(),b=this.getSettings();"auto"!==b.contentWidth&&a.message.width(b.contentWidth),"auto"!==b.contentHeight&&a.message.height(b.contentHeight),this.setHeaderMessage(b.headerMessage)},setHeaderMessage:function(a){return this.getElements("widgetHeader").html(a),this}}),c.addWidgetType("options",c.getWidgetType("lightbox").extend("options",{activeKeyUp:function(a){var b=9;a.which===b&&a.preventDefault(),this.hotKeys[a.which]&&this.hotKeys[a.which](this)},activeKeyDown:function(a){var b=9;if(a.which===b){a.preventDefault();var c,d=this.focusedButton.index();a.shiftKey?(c=d-1,c<0&&(c=this.buttons.length-1)):(c=d+1,c>=this.buttons.length&&(c=0)),this.focusedButton=this.buttons[c].focus()}},addButton:function(b){var c=this,d=c.addElement(b.name,a("<button>").text(b.text));c.buttons.push(d);var e=function(){c.getSettings("hideOnButtonClick")&&c.hide(),a.isFunction(b.callback)&&b.callback.call(this,c)};return d.on("click",e),b.hotKey&&(this.hotKeys[b.hotKey]=e),this.getElements("buttonsWrapper").append(d),b.focus&&(this.focusedButton=d),c},bindHotKeys:function(){this.getElements("window").on({keyup:this.activeKeyUp,keydown:this.activeKeyDown})},buildWidget:function(){c.getWidgetType("lightbox").prototype.buildWidget.apply(this,arguments);var a=this.addElement("buttonsWrapper");this.getElements("widgetContent").append(a)},getClosureMethods:function(){var a=c.getWidgetType("lightbox").prototype.getClosureMethods.apply(this,arguments);return a.concat(["activeKeyUp","activeKeyDown"])},getDefaultSettings:function(){var b=c.getWidgetType("lightbox").prototype.getDefaultSettings.apply(this,arguments);return a.extend(!0,b,{position:{at:"center center-100"},hideOnButtonClick:!0}),b},onHide:function(){this.unbindHotKeys()},onInit:function(){this.buttons=[],this.hotKeys={},this.focusedButton=null},onShow:function(){this.bindHotKeys(),this.focusedButton||(this.focusedButton=this.buttons[0]),this.focusedButton&&this.focusedButton.focus()},unbindHotKeys:function(){this.getElements("window").off({keyup:this.activeKeyUp,keydown:this.activeKeyDown})}})),c.addWidgetType("confirm",c.getWidgetType("options").extend("confirm",{onReady:function(){c.getWidgetType("options").prototype.onReady.apply(this,arguments);var a=this.getSettings("strings"),b="cancel"===this.getSettings("defaultOption");this.addButton({name:"cancel",text:a.cancel,callback:function(a){a.trigger("cancel")},focus:b}),this.addButton({name:"ok",text:a.confirm,callback:function(a){a.trigger("confirm")},focus:!b})},getDefaultSettings:function(){var a=c.getWidgetType("options").prototype.getDefaultSettings.apply(this,arguments);return a.strings={confirm:"OK",cancel:"Cancel"},a.defaultOption="cancel",a}})),c.addWidgetType("alert",c.getWidgetType("options").extend("alert",{onReady:function(){c.getWidgetType("options").prototype.onReady.apply(this,arguments);var a=this.getSettings("strings");this.addButton({name:"ok",text:a.confirm,callback:function(a){a.trigger("confirm")}})},getDefaultSettings:function(){var a=c.getWidgetType("options").prototype.getDefaultSettings.apply(this,arguments);return a.strings={confirm:"OK"},a}})),b.DialogsManager=c}("function"==typeof require?require("jquery"):jQuery,"undefined"!=typeof module?module.exports:window);